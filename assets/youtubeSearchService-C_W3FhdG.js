const f="https://www.googleapis.com/youtube/v3";async function T(n){var e,o,c,a,l,p;const s="AIzaSyCuzsSgHYzMsRfDWHtGFlDhkYJfysD8DYw",r=new URLSearchParams({part:"snippet,contentDetails",id:n,key:s});try{const i=await fetch(`${f}/videos?${r}`);if(!i.ok)return null;const t=(e=(await i.json()).items)==null?void 0:e[0];if(!t)return null;const u=t.snippet.title||"",[d,y]=u.includes(" - ")?u.split(" - ",2):[void 0,u],v=((o=t.contentDetails)==null?void 0:o.duration)||"",b=w(v);return{id:`youtube:${n}`,title:y||u,artist:d||t.snippet.channelTitle,cover_url:((a=(c=t.snippet.thumbnails)==null?void 0:c.high)==null?void 0:a.url)||((p=(l=t.snippet.thumbnails)==null?void 0:l.default)==null?void 0:p.url),youtube_id:n,duration_ms:b,provider:"youtube"}}catch(i){return console.error("getYouTubeVideo error",i),null}}function w(n){try{const s=n.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);if(!s)return 0;const r=parseInt(s[1]||"0",10),e=parseInt(s[2]||"0",10),o=parseInt(s[3]||"0",10);return(r*3600+e*60+o)*1e3}catch{return 0}}async function Y(n,s){const r="AIzaSyCuzsSgHYzMsRfDWHtGFlDhkYJfysD8DYw";try{const e=[],o=`${n} ${s} official`,c=await h(o,r,3);e.push(...c.map(t=>({...t,type:"official"})));const a=`${n} ${s} live`,l=await h(a,r,2);e.push(...l.map(t=>({...t,type:"live"})));const p=`${s} cover`,i=await h(p,r,2);return e.push(...i.map(t=>({...t,type:"cover"}))),e.filter((t,u,d)=>d.findIndex(y=>y.videoId===t.videoId)===u)}catch(e){return console.error("Error searching YouTube:",e),[]}}async function h(n,s,r){const e=new URLSearchParams({part:"snippet",q:n,type:"video",videoCategoryId:"10",maxResults:r.toString(),key:s}),o=await fetch(`${f}/search?${e}`);return o.ok?(await o.json()).items.map(a=>({videoId:a.id.videoId,title:a.snippet.title,channel:a.snippet.channelTitle})):(console.error("YouTube API error:",o.status),[])}export{T as g,Y as s};
